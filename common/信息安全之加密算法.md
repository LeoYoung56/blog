# 密码系统：对称、非对称、单向（hash）
一：密码学基础
二：应用
## 对称秘钥密码模型

**使用情景：**
信道不安全，发送方将信息加密，接收方则将之解密
明文，密文，秘钥，加密算法，解密算法（E、D、p、K、C）
密文在不可靠的信道上传输，即使被截获敌人也无法使用。
密码学的基础假设：秘密必须全寓于秘钥（即便在算法公开的情况下，攻击者还是不能得到明文。  秘密必须全寓于秘钥≠算法应当公开）
藏头诗不属于对称秘钥密码模型：藏头诗中存在冗余信息
**对称秘钥密码模型要求：**
在通信开始之前秘钥在带外传输协商
遵循密码学的基本假设

**密码系统分类：**
分类一（根据加密方法）：替代密码（符号变化）、置换密码（位置变化）、乘积密码（经过多轮的替代、置换）
分类二（根据秘钥本质）：对称秘钥密码系统（加密和解密的秘钥相同）、公开（非对称、双秘钥）秘钥密码系统（加密和解密的秘钥不相同）

分类三（根据明文被处理的方式）：分组密码（明文处理之前先将明文进行分组再进行加密。一般民用，速度较慢）、流密码（来一个单位可以处理一个单位的加密/解密方法。一般军用，速度较快）
**替代密码
古典密码**
**凯撒密码**：替代密码，明文中的字母在密文中使用对应字母后的第三位代替。
凯撒密码一共只有25个，可以使用穷举法攻击。①秘钥少②明文有冗余信息（可根据特征识别，如人类语言）
优化凯撒密码设计好的密码：（好的密码，攻击者除了穷举法之外没有更好的攻击手段。以此则攻击者的攻击成本可以根据k size量化）
增加秘钥数
**单字母表密码**：列一个一一对应的字母表，有26！个秘钥
更多的定义方法：
①无条件安全，无论何种情况都安全（理论存在）
②计算式安全，假设攻击者的计算资源有限，使得攻击者的攻击成本远远大于使用者的使用成本即可
提高单字母表密码安全性：
多对一·
一对多·
**Playfair密码**
2字母分组
`惠斯通规定5*5矩阵中ij不区分
重复字母使用x填充
同行取右边
同列取下边
其他情况取交叉，前者取前同行后同列交叉
攻击：构造26*26的词频分析`
优化：增大分组中字母数量
**多字母表密码**
维吉尼亚密码：使用和明文一样长的秘钥去字母表中找对应字母
攻击：秘钥有循环周期，通过不同周期相同位置的密文来进行词频分析，但这样要求密文数量足够多
改进：使用不循环的秘钥，即秘钥和字母数和明文字母数一样多
**Autokey cipher密码**
使用一段秘钥，前一段的明文加密后作为新的秘钥来加密下一段明文（自动生成秘钥）
攻击：人类语言中出现次数多的字母作为密文也会出现次数较多，即明文中字母的统计规律和密文中的字母统计规律存在联系
优化：去除关联
**现代密码（使用计算机加密解密）
Vernam cipher密码**
AT&T公司（美国电报电信公司（，前身是贝尔电信电报公司）），贝尔实验室（香浓，信息论之父），Vernam
⊕异或 A⊕B=C→A⊕C=B→B⊕C=A
Ci = Pi⊕Ki
Pi = Ci⊕Ki
**置换密码：
Rail Fence cipher**
打乱顺序
Row Transposition ciphers 行置换密码
乘积密码：
Product cipher
从古典密码到现代密码的桥梁（现代密码都是乘积密码）
古典密码的最高峰：转字机（Rotor Machines在二战时期被广泛使用）例如Enigma
·是一种替代密码
·是一种复杂的替代，即乘积密码
·转字越多越复杂
转子转速不同，快速转子、中速转子、慢速转子，各有26格
每一次输入快速转动一格，快速转子转一圈中速转子转一格，中速转子转一圈慢速转子转一格
本质上就是维吉尼亚密码
影写术（藏头诗，火烤显字等）---对应现代密码的信息隐藏技术
·伪装式保密通信
·数字水印（一般用于版权保护）
现代密码（属于对称秘钥密码）
分组密码：解决通讯保密问题
·Ideal block cipher
·S-P-N：S-box:替代盒子、P-box置换盒子，使用S-box和P-box形成的网络
·Feistel（一个团队名）structure：实现一种可逆的乘积密码。实现了SPN思想
Ideal block cipher：分组大小为n个bit，则有2n!个，理想上最好的密码情况是将所有的字母表都用上
Feistel structure：不需要讲所有的密码表用上，只需要用2k个单字母表 需要解决：如何找，找哪几个
S-box:直接替代：在分组密码算法中，是非线性结构，其密码强度直接决定了密码算法的好坏。
P-box:置换顺序：目的是让明文和密钥的影响迅速扩散到整个密文中。即1位的明文或密钥的改变会影响到密文的多个比特
香浓：使用S-box和P-box达到confusion和diffusion的效果
Diffusion：扩散：P-box
Confusion：扰乱：S-box
SPN中S-box体积一般较小，P-box体积一般比较大
SPN的雪崩效应：Diffusion的作用可使得明文中一个Bit发生变化，在密文中会有很多个bit发生改变
Feistel structure：设计一个可逆结构、一次只加密一半、。。。
每64位分组，一组作为输入，若不够64位，则填充足64位：podding
F函数，F（K，R），K是秘钥，R是输入的一半
S盒子和P盒子都是由函数F实现
此时的可逆为解密的第一轮和加密的第一轮是互逆的。而且此方法中解密算法和加密算法相同，只需要将密文又作为输入输入到结构中，输出则为原明文。
F方法相同，如何做到输入的算法和输出的算法可逆？即如何做到输入同样的函数，输入1，输入2得到结果，可以使得输入1，结果得到输入2（或输入2，结果得到输入1）这样的函数?    ------使用置换的性质⊕异或 A⊕B=C→A⊕C=B→B⊕C=A
因此F不需要可逆，因为置换可逆
Feistel structure的参数：
Number of rounds
DES（Data Encryption Standard 数据加密标准）
使用最广泛的分组密码算法，属于对称加密算法体系
DES的一部分是FEOSTEL结构，在该结构开始前进行初始置换initial permutation，结构后进行初始置换的逆置换，该处理不影响可逆性
初始置换对应初始置换表
初始置换的逆置换对应逆置换表        初始置换x位置的值为y，则逆表中y位置的值为x   例：x,y 1-64
F中的E-table：扩展置换 32bit输入48bit输出
PC*1置换最后一位是奇偶校验位
循环左移位 Left Shifts
公开秘钥密码学（非对称秘钥密码模型、双秘钥密码模型）     运行速度慢，不适合大型数据通信，是对称秘钥密码模型的补充（进行对称秘钥密码模型的秘钥交换），而不是密码模型的替代。解决秘钥交换问题
解决秘钥协商的困难
通信双方低位不对等
每一个参与通信的人有都有一对秘钥，一个公开秘钥一个私有秘钥。
公开秘钥进行加密，私有秘钥进行解密
公开秘钥密码系统，六元组
容易：随着问题规模（key size）增长，计算量（时间复杂度O）以多项式式时间增加
困难问题：.........................................，..................指数式时间..............
▲密码对之间可以相互交换使用：M=DKRb[EKUb(M)]=DKUb[EKRb(M)]       KRb  b的公开秘钥
红色部分可实现数字签名
签名的安全服务：①身份认证（双方利益一致）②抗抵赖（双方利益不一致）
PPT17的意义：①证明消息是由Bob发的②消息可作为A发过该消息的证明
KKb  b的对称秘钥
RSA算法：采用大素数相乘，相乘很容易，但因子分解很困难
n=p*q
Φn=（p-1）（q-1）
φn是小于n的和n互质的数的个数
一般e也取质数，可取较小如10位
ged（e,φn）=1  e和φn的最大公约数为1,即e和φn互质
e*d=1 mod φn    e和d的乘积和φn相除的余数是1
求d算法为多项式算法时间复杂度
幂的模运算可以降幂计算
Ckmod n=(C2modn)k/2mod n*

安全：保密性、完整性、可用性、抗抵赖

# 报文鉴别
**定义（服务内容）**：收到报文后接收者能对以下内容进行鉴别：
1. 完整性
2. 证实发送者身份
3. 对发送者抗抵赖

**解决方案**：
1.  使用加密算法加密提供鉴别服务
2.  使用报文鉴别码（MAC）
3.  使用hash算法

* * *
**使用加密算法加密提供鉴别服务**
对称秘钥密码方案：能实现服务中前两点，且无法实现自动化
公钥加密方案：三个服务都不可实现
私钥加密方案：三个服务都可实现，但不具备保密性
双秘钥加密方案：三个服务都可实现，且具有保密性


* * *
**使用报文鉴别码--- ---MAC**
使用算法将报文全文映射到一个鉴别码
算法不需要可逆

可实现报文鉴别的前两个服务（确认秘钥没有外泄的情况下）

算法原理：扩散扰乱

* * *
DAA算法：


* * *
hash常用来检测用户下载的文件是否完整
使用私钥加密文件hash值的来实现数字签名

hash算法：将任意长度的信息映射到固定长度的hash值

m位
DDA解密需要


## 公钥基础设施--- ---KPI：公开秘钥分发

### 证书
解决的问题：公钥的发布要能让大家知道。因此公钥持有人或可选择在自己的个人主页上发布公钥。但存在的问题是我们难以确认该主页是否真正由对应身份的人发布。因此KPI验证公钥以及公钥持有人的身份绑定问题。

证书意义：公钥和使用者身份建立联系
证书颁发者：可信的第三方机构--- ---CA

证书结构：
主体确认信息
主题公钥
CA名

End-Entity: 端实体，即CA的最终用户

分布式信任：
PGP，没有中间的信任锚点






## 身份认证
对于身份认证的威胁：重放攻击（replay）；穷举攻击；字典攻击（在线和离线）
技术关键：保证身份认证的鲜活性

好的身份认证协议：
Sound：真实用户可成功认证
Non-transferable:不可传播
        ：不可假冒

身份认证的凭据：
1.口令2.信用设备3.遗传信息

双层用法：使用段口令锁存有长指令的信用设备

基于口令的身份认证（弱身份认证，密码认证）
最大的问题：口令固定

salt：哈希算法中的撒盐操作

避免在线字典攻击的方法：避免弱口令

离线字典攻击的防范方法：撒盐
离线字典攻击：对于已知的哈希函数，可以预先计算一个哈希字典。当password文件被泄露（非明文），攻击者获得该password文件后，与已建立的字典进行对比查找，即可找到一个与password的哈希值相等的字符串（未必就是password，因为哈希有冲撞）。

服务器端的攻击：
1、网络钓鱼（phishing）：钓鱼网站
2、共同口令问题：用户在不同网站的账号设置相同口令，攻击者在安全性低的网站进行攻击获取password，到安全性高的网站使用
解决方案：在客户端设置一个软件，输入相同的客户password，生成对于不同网站不同的真正使用password

客户端问题：
1、恶意软件的输入监听（最难防范）：防范，使用单独硬件，该硬件不能被客户端机器读取

动态口令：保证鲜活性
方案：共享一个口令列表，一直更新直到口令用完

Lamport's OTP
害怕：预先播放攻击
缺陷：需要出现初始化开销较大；不支持双向验证；传输保密性没有考虑

USBK：U盾，其中的私钥不会离开USBK，且有计算能力，客户端发起请求后发到USBK中使用私钥完成签名，再将请求签名发到网页发往服务器，不但能验证身份，还能对请求操作抗抵赖。

强身份认证：
1.challenge-response：质询/应答：
基于协议组件
也是一次性口令
防止replay攻击

2.单向应答：one way function

3.基于公开密钥加密

4.基于数字签名
certA：A的公开密钥证书
发A的证书给B：拿到A的公开密钥

## kerberos：看守地狱之门的三头狗
kerberos防止重放攻击的手段是时间限制，这要求客户端与服务器的时间戳高度统一，信息传输速率够高，一般用于局域网。
身份认证功能剥离
解决对称秘钥分发

单点登陆
不可重放攻击

术语：
C=客户
AS=认证服务器（存放着所有用户及用户口令信息）
V=服务器
IDc=在C上的用户标识符
IDv=V的标识符
Pc=在C上的用户口令
ADc=C的网络地址
Kv=AS和V共享的加密密钥

Ticket= EKv[IDc||ADc||IDv]
Kc = 使用用户的口令生成的对称密钥
TS = time stamps 时间戳，作为随机数功能。常常使用发送随机数发起质询，返回随机数加一作为应答

质询-应答是构造更加复杂的协议的组件

TGS=票据许可服务器 Ticket granting system:
完成授权步骤
提问：在kerberos中有超过三个质询和应答，找出三个。



## Web和电子商务安全
安全服务（需求）：保密性，完整性，身份认证，抗抵赖，可用性
## SSL（TLS）协议
①web安全问题的威胁
内外网的设置：防火墙 停火区DMZ
非军事区的机器：该区域内的服务器（webserver）内外网都可以访问
webserver常被作为跳板被黑客用于内网攻击

http协议就是一个webserver协议，明文传送
面临的威胁：是否可以保证：数据保密；完整性；防御解决服务攻击（如今也没有彻底解决）；双方身份验证（http一定程度上服务器有对用户机的认证即登录要求。但是没有对服务器的认证）

所以需要增加安全机制。问题：完全机制加到哪一个网络层？
![6057a6c7088fbc9da14759ea88ae70ac.png](en-resource://database/515:1)

传输层：TCP;UDP。SSL面向TCP不面向UDP
网络层：IP

在网络层、传输层的加密和应用层的加密的区别：在应用层的加密是应用本身的行为，而在网络层和传输层的加密是一个公共的加密服务。

在网络层和在传输层加密的区别：都是公共服务，但是网络层的加密可以在路由器上实现，可以保护路由器下整个网络，传输层只能保护到应用

②电子商务：广义：用电子的方法完成商务交易，包括电话，电报
狭义：基于web和internet完成的商务交易
电子商务的涉及方比web更多：买家，卖家，支付第三方，购物平台，网银平台等等

安全性和隐私性

## 解决方案：SSL：secure socket layer安全套接字协议/transport layer security传输层安全协议
IPSec是把IP替换
SSL/TLS 是在TCP前加了一层
由最初Netscape网景公司开发（最初的浏览器IE之前）
TSL1.0版本相当于SSL3.1版本

互联网的异构使得协议需要有很多算法支持

传输层：端到端；网络层：点到点

ssl本身分为两层：ssl记录协议；ssl握手协议，ssl密码变换协议，ssl警告协议
### 底层ssl记录协议：只使用对称秘钥就可以实现
提供保密性和完整性服务
功能：用来封装高层协议

### ssl握手协议：使用公开秘钥实现
客户机和服务器之间的相互认证
协商加密算法和密钥
提供连接安全协议：身份认证：至少对一方实现认证（对服务器的认证必须，对客户的认证可选），也可以双向认证
安全协商共享密钥

工作流程：

        .  先握手    
        单向身份认证，双向认证（可选）
        协商SSL会话的密钥等参数
        .
        .
        .
        
        
        
        
        
        
记录协议对一下内容进行封装

    密码变换协议：一个bit的数据，即表示从对称秘钥到公开秘钥的变换
    警告协议：两个bit的数据：（类型：警告）
    握手协议
    其他上层协议，如HTTP

SSL握手协议：有阴影的消息可选，没有的必发
![8154ba9129581f373655827f498ad12d.png](en-resource://database/516:1)


    四个阶段：
    第一阶段：双方交换hello消息，对于算法、交换随机数值等协商一致
    client_hello消息：
    
    第二阶段：
    server_hello_done 是一个响应消息，把client_hello用自己的私钥加密，客户端使用客户端的公钥解密，可对服务器进行身份认证
    
    第三阶段：
    如果服务器要认证客户机身份，则需要有第三步中的两条可选消息
    最重要的任务：实现秘钥交换
    
    第四阶段：
    相互加密一个字节的消息发送然后退出，后面的使用对称秘钥加密
    
    
 SSL相关开源项目：open-SSL
 
##  SET协议
注意：网关
 SET协议提供的服务：保密、完整、认证、隐私保护
 模拟在线信用卡交易的过程
 set协议并没有被大范围使用，证书颁发问题太麻烦
 主要研究如何实现隐私保护，购物十步中的第六步
 实现方法：双重数字签名
 
###  IP Security：可以在主机上实现也可以在路由器上实现，问题：路由器之间如何实现密钥交换
作用：报文鉴别，报文加密，密钥管理
密钥管理协议很复杂

 内核
 
 IPsec 在ipv6中是强制的，在ipv4中是可选的
 AH：报文鉴别/认证头
 ESP：安全Payload的封装
 
可防止： spoofing：IP地址假冒，replay：重放攻击
mutable field：IP头中的可变区域：分片信息

tunnel mode 可用来实现VPN

 
 ESP：提供内容保密以及有限的流量保密服务，也可提供authentication服务
 
 加padding的原因：一定程度上做流量的保密

 
 
 
 
 

* * *
# PJ--- --- IBE：实现区块链的公开秘钥
基于身份的加密（IBE）
最大问题：公钥是一串无意义的二进制数，无法通过公钥进行身份认证
解决方式一：KPI。问题：对kpi高要求，存储，查询要求

身份：一串跟用户直接相关的有意义数字，如身份证号

使用身份作为公钥加密就不再需要KPL：公钥管理者

PKG：私钥生成者

[https://max.book118.com/html/2017/0318/95960140.shtm](https://max.book118.com/html/2017/0318/95960140.shtm)
[https://blog.csdn.net/qq_36291381/article/details/80699746](https://blog.csdn.net/qq_36291381/article/details/80699746)
* * *


## 区块链
